databaseChangeLog:
  - changeSet:
      id: 001-create-logs-collection
      author: you
      changes:
        - createCollection:
            collectionName: logs

        # تنظیم JSON Schema Validator با collMod
        - runCommand:
            command:
              collMod: "logs"
              validator:
                $jsonSchema:
                  bsonType: "object"
                  required: ["date", "level", "message"]
                  properties:
                    date:
                      bsonType: "date"
                      description: "must be a date and is required"
                    level:
                      enum: ["TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL"]
                      description: "must be one of TRACE/DEBUG/INFO/WARN/ERROR/FATAL"
                    message:
                      bsonType: "string"
                      minLength: 1
                      description: "must be a non-empty string"
                    # اگر می‌خواهید id را هم کنترل کنید:
                    _id:
                      bsonType: ["objectId", "string"]
              validationLevel: "moderate"
              validationAction: "error"

        # ایندکس‌های کاربردی
        - createIndex:
            collectionName: logs
            keys:
              date: 1
            name: idx_logs_date

        - createIndex:
            collectionName: logs
            keys:
              level: 1
              date: -1
            name: idx_logs_level_date

        # ایندکس متنی برای جستجو در message (اختیاری)
        - createIndex:
            collectionName: logs
            keys:
              message: "text"
            name: idx_logs_message_text

  - changeSet:
      id: 002-seed-logs
      author: you
      changes:
        - insertOne:
            collectionName: logs
            document:
              date: { $date: "2025-01-01T00:00:00Z" }
              level: "INFO"
              message: "Application started"

        - insertMany:
            collectionName: logs
            documents:
              - { date: { $date: "2025-01-01T12:00:00Z" }, level: "WARN",  message: "High memory usage" }
              - { date: { $date: "2025-01-02T09:30:00Z" }, level: "ERROR", message: "DB connection timeout" }